<!DOCTYPE HTML>
<html>
<head>
<meta charset="utf-8"/>
<title> 마이페이지 </title>
<style = "css/text">
		#left{
			display: block;
			float: left;
			width:200px;
			margin: 0 0 0 0;
			text-align: right;
			overflow-y: auto;
			}
		#right{
			display: block;
			float: right;
			width: 550px;
			text-align: left;
			overflow-y: auto;			
			}
		#center{
			display:block;
			margin: 30px 0 0 0;
			text-align:center;
			}
		.red{
			color: red;
		}
</style>
</head>
<body id="signup">
    <form>    
      	<fieldset>
				<legend>회원 정보</legend>
				<div id="left">
				<p>ID&nbsp;&nbsp;</p>
				<p>비밀번호<span class="red">*</span></p>
				<p>비밀번호 확인<span class="red">*</span></p>
				<p>마일리지</p>
				<p>이름</p>
				<!-- 마일리지 확인을 위해 추가했습니다 -제균 -->
				<p>휴대폰 번호</p>
				</div>
				<div id="right">
				<p><strong><input type = "text" id = "member_id" value = "" disabled/></strong></p>
				<p><strong><input type = "password" id = "pw1" placholder = "****" /></strong></p>
				<p><strong><input type = "password" id = "pw2" placholder = "****" /></strong></p>
				<!-- 마일리지 확인을 위해 추가했습니다 -제균 -->
				<p><strong><input type = "text" id = "mileageMember" value = "" disabled/></strong></p>
				
				<p><strong><input type = "text" id = "name" placceholder="" /></strong></p>
				<p><strong><input type = "tel" id = "telephone" placeholder = "000-0000-0000" pattern = "[0-9]{2,3}-[0-9]{3,4}-[0-9]{4}" /></strong></p>
			
				</div>
		</fieldset>
		
		<div id="center">
		<input type = "button" value = "저장" onclick = "save_change()"/>
		<input type = "button" value = "취소" onclick = "pageload()" />
		</div>
    </form> 
   <script type = "text/javascript">
		var localStorage = window.localStorage;
		var members_db = JSON.parse(localStorage.getItem("members"));
		var cnt=-1;
		for(var i=0; i<members_db.length; i++){
			if(members_db[i][7]){
				cnt=i;
				break;
			}
		}
		if(cnt==-1){                               //login status가 false면 페이지 보여주지 않고 화면전환 
			alert("권한이 없습니다");
			window.location.replace("login.html");// 관리자 계정 current user 값을 false로 변경 후 login 페이지로 이동
		}
			
		var pw_change_1 = document.getElementById("pw1");
		var pw_change_2 = document.getElementById("pw2");
		var name_change = document.getElementById("name");
		var tel_change = document.getElementById("telephone");
		var get_id = document.getElementById("member_id");
		var mileage_check = document.getElementById("mileageMember");
		
		get_id.value = members_db[cnt][0];
		pw_change_1.placeholder = members_db[cnt][1];
		pw_change_2.placeholder = members_db[cnt][1];
		name_change.placeholder = members_db[cnt][2];
		tel_change.placeholder = members_db[cnt][3];
		mileage_check.value = members_db[cnt][5];
				
		function save_change(){
			if(pw_change_1.value != "" && pw_change_1.value == pw_change_2.value){
				members_db[cnt][1] = pw_change_1.value;
			}
			else{
				alert("입력한 비밀번호가 서로 같지 않습니다.");
				return;
			}
			if(name_change.value != ""){
				members_db[cnt][2] = name_change.value;
			}
			if(tel_change.value != ""){
				members_db[cnt][3] = tel_change.value;
			}
			localStorage.setItem("members", JSON.stringify(members_db));
			alert("회원 정보가 변경되었습니다.");
			pageload();
		}
		
		function pageload(){
			window.location.reload(); //초기 화면으로 돌아가기
		}
	</script>
</body>
</html>
