<!DOCTYPE html>
<html>
<head>
	<title>Main</title>
	<meta charset="utf-8">

	<style type="text/css">

		* {
			font-size: 12px;
		}

		#section_login {
			float: left;
			margin-bottom: 50px;
		}

		#section_products {
			clear: left;
		}

		table {
			float: left;
			clear: none;
			margin: 0 5px;
			padding: 5px 0;
			width: 150px;
		}

		.product {
			line-height: 1px;
			text-align: center;
		}

		#product_quantity {
			width: 50px;
		}

		#section_addItem {
			clear: left;
		}
		
		a {
			display: block;
			text-decoration: none;
		}
		#check{
		}
	</style>

</head>
<body onload='loadInfo();'>

<div id="section_products">

	<div id="section_list" class="product list">
	</div>

	<script type="text/javascript">
		var localStorage = window.localStorage;
		/*var items = [];

		items[0] = [];
			items[0] = [];
			items[0][0] = "장미";
			items[0][1] = "25000";
			items[0][2] = "20";
			items[0][3] = "flower.jpg";
		items[1] = [];
			items[1][0] = "수국";
			items[1][1] = "15000";
			items[1][2] = "4";
			items[1][3] = "flower.jpg";
		items[2] = [];
			items[2][0] = "수국2";
			items[2][1] = "150000";
			items[2][2] = "4";
			items[2][3] = "flower.jpg";
		items[3] = [];
			items[3][0] = "크리스마스 로즈";
			items[3][1] = "25000";
			items[3][2] = "20";
			items[3][3] = "flower.jpg";
		items[4] = [];
			items[4][0] = "장미쓰";
			items[4][1] = "25000";
			items[4][2] = "20";
			items[4][3] = "flower.jpg";
		items[5] = [];
			items[5][0] = "빨간장미";
			items[5][1] = "25000";
			items[5][2] = "20";
			items[5][3] = "flower.jpg";

		localStorage.setItem("items", JSON.stringify(items));*/
		var items_db = JSON.parse(localStorage.getItem("items"));
		var cnt = -1;
		function loadInfo() {
			for (var i =0; i < items_db.length; i++)
				{
					cnt = i;
					
					var item = document.createElement("table");
					item.id = "item_"+i;
					item.count = cnt;
					document.getElementById("section_list").appendChild(item);

					var tr01 = document.createElement("tr");
					document.getElementById("item_"+i).appendChild(tr01);
					

					var td01 = document.createElement("td");
					td01.class = "product image";
					td01.setAttribute("colspan", "2");
					tr01.appendChild(td01);

					td01.innerHTML = '<img id="product_image" src = "' + items_db[i][3] +'" width="150px" height="150px">';
					
					var tr02 = document.createElement("tr");
					document.getElementById("item_"+i).appendChild(tr02);

					var td02 = document.createElement("td");
					td02.class = "product name";
					td02.setAttribute("colspan", "2");
					tr02.appendChild(td02);

					td02.innerHTML = '<p id="product_name">' + items_db[i][0] +'</p>';

					var tr03 = document.createElement("tr");
					document.getElementById("item_"+i).appendChild(tr03);

					var td03 = document.createElement("td");
					td03.class = "product price";
					td03.setAttribute("colspan", "2");
					tr03.appendChild(td03);

					td03.innerHTML = '<p id="product_price">' + items_db[i][1] +' 원</p>';

					var tr04 = document.createElement("tr");
					document.getElementById("item_"+i).appendChild(tr04);

					var td04 = document.createElement("td");
					td04.class = "product storage";
					td04.setAttribute("colspan", "2");
					tr04.appendChild(td04);

					td04.innerHTML = '<p id="product_image">' + items_db[i][2] +' set</p>';

					var tr05 = document.createElement("tr");
					document.getElementById("item_"+i).appendChild(tr05);

					var td05_1 = document.createElement("td");
					td05_1.innerHTML = '<input id="product_quantity'+i+'" type="number" step="1" min="1" value="1">';
					tr05.appendChild(td05_1);

					var td05_2 = document.createElement("td");
					td05_2.innerHTML = '<button onclick="changeQuantity('+i+')">수량 변경</button>'; //추가되어 최정 변경되는 수량을 입력받아 해당 내용을 db에 overwrite 함.
					tr05.appendChild(td05_2);
					
					document.getElementById("product_quantity"+i).max = items_db[i][2];
				}
}
function changeQuantity(product_id){
	var change =parseInt(document.getElementById("product_quantity"+product_id).value);
	if(change<=0){
		alert("변경 값을 입력해주세요");
	}
	else{
		items_db[product_id][2]=change;
		localStorage.setItem("items", JSON.stringify(items_db)); //DB에 새로운 값 덮어씌우기
		window.location.replace("product_control.html"); //새로고침
	}
}
	</script>

</div>

<div id="section_addItem">
	<a href="#"><button>상품 추가하기</button></a>
</div>


</body>
</html>
